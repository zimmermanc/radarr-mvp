# =============================================================================
# Docker Environment Configuration for Radarr MVP
# =============================================================================
# This file contains Docker-specific environment variables
# Copy to .env and customize for your deployment

# =============================================================================
# CONTAINER CONFIGURATION
# =============================================================================

# Build target (development, production, debug)
BUILD_TARGET=production

# User/Group IDs for file permissions (should match your host user)
PUID=1000
PGID=1000

# Timezone
TZ=UTC

# =============================================================================
# DATABASE CONFIGURATION (PostgreSQL)
# =============================================================================

# PostgreSQL container settings
POSTGRES_DB=radarr
POSTGRES_USER=radarr
POSTGRES_PASSWORD=change_me_in_production
POSTGRES_PORT=5432

# Production PostgreSQL settings
POSTGRES_MAX_CONNECTIONS=100
POSTGRES_SHARED_BUFFERS=256MB
POSTGRES_EFFECTIVE_CACHE_SIZE=1GB
POSTGRES_WORK_MEM=4MB
POSTGRES_MAINTENANCE_WORK_MEM=64MB
POSTGRES_LOG_SLOW_QUERIES=1000

# PostgreSQL paths (production)
POSTGRES_DATA_PATH=/opt/radarr/postgres
POSTGRES_BACKUP_PATH=/opt/radarr/backups/postgres

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================

# Redis container settings
REDIS_PORT=6379
REDIS_MAX_MEMORY=256mb
REDIS_PASSWORD=change_me_in_production

# Redis paths (production)
REDIS_DATA_PATH=/opt/radarr/redis

# =============================================================================
# APPLICATION CONFIGURATION
# =============================================================================

# Radarr server settings
RADARR_PORT=7878
RADARR_MAX_CONNECTIONS=1000
RADARR_REQUEST_TIMEOUT=30

# Database connection settings
DATABASE_MAX_CONNECTIONS=10
DATABASE_CONNECT_TIMEOUT=30

# Metrics and monitoring
METRICS_PORT=9090

# =============================================================================
# EXTERNAL SERVICES CONFIGURATION
# =============================================================================

# Prowlarr settings (set these in production)
PROWLARR_BASE_URL=http://prowlarr:9696
PROWLARR_API_KEY=your_prowlarr_api_key_here
PROWLARR_TIMEOUT=30
PROWLARR_PORT=9696

# qBittorrent settings (set these in production)
QBITTORRENT_BASE_URL=http://qbittorrent:8080
QBITTORRENT_USERNAME=admin
QBITTORRENT_PASSWORD=your_qbittorrent_password_here
QBITTORRENT_TIMEOUT=30
QBITTORRENT_PORT=8080
QBITTORRENT_BT_PORT=6881

# TMDB API key (required for movie metadata)
TMDB_API_KEY=your_tmdb_api_key_here

# =============================================================================
# VOLUME PATHS (HOST DIRECTORIES)
# =============================================================================

# Media directories (adjust paths for your setup)
MOVIES_PATH=./data/movies
DOWNLOADS_PATH=./data/downloads

# Application data paths (production)
RADARR_CONFIG_PATH=./config/prod
RADARR_CONFIG_DATA_PATH=/opt/radarr/config
RADARR_LOGS_PATH=/opt/radarr/logs

# SSL certificates path (if using HTTPS)
SSL_CERT_PATH=./certs

# =============================================================================
# IMPORT PIPELINE CONFIGURATION
# =============================================================================

# Import behavior settings
IMPORT_DRY_RUN=false
IMPORT_MIN_CONFIDENCE=0.3
IMPORT_SKIP_SAMPLES=true
IMPORT_CONTINUE_ON_ERROR=true
IMPORT_MAX_PARALLEL=4

# =============================================================================
# LOGGING AND DEBUGGING
# =============================================================================

# Log level (trace, debug, info, warn, error)
RUST_LOG=info

# JSON formatted logs (useful for log aggregation)
LOG_JSON_FORMAT=true

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================

# API key for Radarr API access (generate a random 32-character string)
RADARR_API_KEY=generate_a_secure_api_key_here

# Enable API key authentication
API_KEY_REQUIRED=false

# CORS settings (restrict in production)
CORS_ALLOWED_ORIGINS=""

# =============================================================================
# PERFORMANCE TUNING
# =============================================================================

# Resource limits (production)
RADARR_CPU_LIMIT=2.0
RADARR_MEMORY_LIMIT=1G
RADARR_CPU_RESERVATION=0.5
RADARR_MEMORY_RESERVATION=512M

POSTGRES_CPU_LIMIT=1.0
POSTGRES_MEMORY_LIMIT=1G
POSTGRES_CPU_RESERVATION=0.2
POSTGRES_MEMORY_RESERVATION=256M

REDIS_CPU_LIMIT=0.5
REDIS_MEMORY_LIMIT=512M
REDIS_CPU_RESERVATION=0.1
REDIS_MEMORY_RESERVATION=128M

# Download settings
MAX_CONCURRENT_DOWNLOADS=5
DOWNLOAD_TIMEOUT=300

# =============================================================================
# MIGRATION AND STARTUP SETTINGS
# =============================================================================

# Run database migrations on startup
RUN_MIGRATIONS_ON_STARTUP=true

# =============================================================================
# DEVELOPMENT SETTINGS (override in docker-compose.override.yml)
# =============================================================================

# Development mode toggles
DEVELOPMENT_MODE=false
MOCK_PROWLARR=false
MOCK_QBITTORRENT=false

# =============================================================================
# NETWORK CONFIGURATION
# =============================================================================

# Docker network subnet
DOCKER_SUBNET=172.20.0.0/16

# =============================================================================
# BACKUP CONFIGURATION
# =============================================================================

# Backup retention settings
BACKUP_RETENTION_DAYS=30
BACKUP_SCHEDULE="0 2 * * *"  # Daily at 2 AM

# =============================================================================
# MONITORING AND HEALTH CHECKS
# =============================================================================

# Health check intervals
HEALTH_CHECK_INTERVAL=30

# Cleanup interval (for removing old logs, temp files, etc.)
CLEANUP_INTERVAL=3600

# =============================================================================
# EXAMPLE CONFIGURATIONS FOR DIFFERENT ENVIRONMENTS
# =============================================================================

# --- DEVELOPMENT ENVIRONMENT ---
# BUILD_TARGET=development
# RUST_LOG=debug
# LOG_JSON_FORMAT=false
# IMPORT_DRY_RUN=true
# API_KEY_REQUIRED=false
# DEVELOPMENT_MODE=true

# --- STAGING ENVIRONMENT ---
# BUILD_TARGET=production
# RUST_LOG=info
# LOG_JSON_FORMAT=true
# API_KEY_REQUIRED=true
# POSTGRES_PASSWORD=secure_staging_password
# REDIS_PASSWORD=secure_staging_password

# --- PRODUCTION ENVIRONMENT ---
# BUILD_TARGET=production
# RUST_LOG=warn
# LOG_JSON_FORMAT=true
# API_KEY_REQUIRED=true
# DATABASE_MAX_CONNECTIONS=20
# RADARR_MAX_CONNECTIONS=2000
# POSTGRES_PASSWORD=very_secure_production_password
# REDIS_PASSWORD=very_secure_production_password

# =============================================================================
# SECURITY NOTES
# =============================================================================
#
# 1. CHANGE DEFAULT PASSWORDS:
#    - POSTGRES_PASSWORD: Use a strong, unique password
#    - REDIS_PASSWORD: Use a strong, unique password
#    - QBITTORRENT_PASSWORD: Set your qBittorrent password
#
# 2. API KEYS:
#    - PROWLARR_API_KEY: Get from Prowlarr Settings > General > Security
#    - TMDB_API_KEY: Get free API key from https://www.themoviedb.org/settings/api
#    - RADARR_API_KEY: Generate a random 32-character string
#
# 3. PRODUCTION SECURITY:
#    - Set API_KEY_REQUIRED=true in production
#    - Restrict CORS_ALLOWED_ORIGINS to your domains
#    - Use HTTPS in production (configure SSL_CERT_PATH)
#    - Regularly update passwords and API keys
#
# 4. FILE PERMISSIONS:
#    - Set PUID/PGID to match your host user for proper file access
#    - Ensure volume paths are writable by the specified user
#
# =============================================================================